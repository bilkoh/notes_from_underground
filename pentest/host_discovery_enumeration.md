# Host Discovery and Enumeration
List of useful commands, starting from the broadest, quickest, superficial, to the least.

# find all pingable host in a subnet (no port scan)
```
sudo nmap  10.0.2.0/24 -sn -n -PE -T4 -oG output.nmap
```

## explanation
`10.0.2.0/24`: Scans the 10.0.2.x range, from 1 to 254.

`-sn`: Ping scan; no port scan.

`-n`: No DNS resolution.

`-PE`: ICMP echo request discovery.

`-T4:` Aggressive timing; faster scan.

`-oG output.nmap`: Greppable output saved to output.nmap

# extract hosts in greppable output to file 
```
grep "Status: Up" output.nmap | cut -d ' ' -f 2 > targets.txt
```

---
# scan top 500 ports of all hosts in file
```
nmap -Pn --open -n --top-ports 500 -T4 -oG top500.nmap -iL targets.txt
```

## explanation
`-Pn`: Skip host discovery; treat all hosts as live.

`--open`: Show only open ports in the output.

`-n`: Don't resolve IP addresses to hostnames.

`--top-ports 1000`: Scan the top 1000 most common ports.

`-T4`: Use aggressive timing for faster scanning.

`-oG top1000.nmap`: Save the greppable output to the file top1000.nmap.

`-iL targets.txt`: Read targets to scan from the file targets.txt.

---
# detailed scan on one host
```
sudo -sV -O -p- -oA detailed_scan 10.0.2.15
```

## explanation
`-sV`: Detect service versions.

`-O`: Enable OS detection.

`-p-`: Scan all 65535 ports.

`-oG ultra_detailed_scan`: Save the greppable output.

`10.0.2.15`: The IP address of the target host.

---
# ultra detailed scan on one host
```
sudo nmap -sV -sC -O -p- --reason --script="default,vuln" -oG ultra_detailed_scan 10.0.2.15
```

## explanation
`-sV`: Detect service versions.

`-sC`: Run default scripts for more details.

`-O`: Enable OS detection.

`-p-`: Scan all 65535 ports.

`--reason`: Show the reason each port is set to a specific state.

`--script="default,vuln"`: Run default scripts and check for vulnerabilities.

`-oG ultra_detailed_scan`: Save the greppable output.

`10.0.2.15`: The IP address of the target host.

---
# Other resources
https://github.com/InfoSecWarrior/Offensive-Pentesting-Host
